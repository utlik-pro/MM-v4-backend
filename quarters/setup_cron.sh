#!/bin/bash

# –°–∫—Ä–∏–ø—Ç —É—Å—Ç–∞–Ω–æ–≤–∫–∏ cron-–∑–∞–¥–∞—á–∏ –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

echo "üöÄ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫–≤–∞—Ä—Ç–∏—Ä"
echo ""
echo "–í—ã–±–µ—Ä–∏—Ç–µ —á–∞—Å—Ç–æ—Ç—É –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:"
echo "1) –ö–∞–∂–¥—ã–π —á–∞—Å"
echo "2) –ö–∞–∂–¥—ã–µ 30 –º–∏–Ω—É—Ç"
echo "3) –ö–∞–∂–¥—ã–µ 15 –º–∏–Ω—É—Ç"
echo "4) –î–≤–∞ —Ä–∞–∑–∞ –≤ –¥–µ–Ω—å (9:00 –∏ 21:00)"
echo "5) –†–∞–∑ –≤ –¥–µ–Ω—å (9:00)"
echo ""
read -p "–í–∞—à –≤—ã–±–æ—Ä (1-5): " choice

# –ü—É—Ç—å –∫ —Å–∫—Ä–∏–ø—Ç—É
SCRIPT_PATH="/Users/admin/MM-RAG/quarters/auto_update.py"

# –°–æ–∑–¥–∞–Ω–∏–µ cron-–∑–∞–¥–∞—á–∏
case $choice in
    1)
        CRON_LINE="0 * * * * /usr/bin/python3 $SCRIPT_PATH --notify"
        echo "‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –±—É–¥–µ—Ç –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç—å –∫–∞–∂–¥—ã–π —á–∞—Å"
        ;;
    2)
        CRON_LINE="*/30 * * * * /usr/bin/python3 $SCRIPT_PATH --notify"
        echo "‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –±—É–¥–µ—Ç –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç—å –∫–∞–∂–¥—ã–µ 30 –º–∏–Ω—É—Ç"
        ;;
    3)
        CRON_LINE="*/15 * * * * /usr/bin/python3 $SCRIPT_PATH --notify"
        echo "‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –±—É–¥–µ—Ç –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç—å –∫–∞–∂–¥—ã–µ 15 –º–∏–Ω—É—Ç"
        ;;
    4)
        CRON_LINE="0 9,21 * * * /usr/bin/python3 $SCRIPT_PATH --notify"
        echo "‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –±—É–¥–µ—Ç –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç—å –≤ 9:00 –∏ 21:00"
        ;;
    5)
        CRON_LINE="0 9 * * * /usr/bin/python3 $SCRIPT_PATH --notify"
        echo "‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –±—É–¥–µ—Ç –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç—å –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 9:00"
        ;;
    *)
        echo "‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π –≤—ã–±–æ—Ä"
        exit 1
        ;;
esac

# –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ crontab
(crontab -l 2>/dev/null; echo "$CRON_LINE") | crontab -

echo ""
echo "üìÖ Cron-–∑–∞–¥–∞—á–∞ —É—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–∞!"
echo ""
echo "–¢–µ–∫—É—â–∏–µ –∑–∞–¥–∞—á–∏ cron:"
crontab -l | grep auto_update.py
echo ""
echo "–î–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –≤—Å–µ—Ö –∑–∞–¥–∞—á –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ: crontab -l"
echo "–î–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ: crontab -e"
echo "–î–ª—è —É–¥–∞–ª–µ–Ω–∏—è –≤—Å–µ—Ö –∑–∞–¥–∞—á –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ: crontab -r"
echo ""
echo "üìù –õ–æ–≥–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤: /Users/admin/MM-RAG/quarters/updates.log"