#!/bin/bash
# –°–∫—Ä–∏–ø—Ç –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ MM-RAG

echo "======================================"
echo "üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ MM-RAG"
echo "======================================"
echo ""
echo "–í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—Ä–∏–∞–Ω—Ç –∑–∞–ø—É—Å–∫–∞:"
echo ""
echo "1) –ó–∞–ø—É—Å—Ç–∏—Ç—å –°–ï–ô–ß–ê–° (–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞–∂–¥—ã–π —á–∞—Å)"
echo "2) –ù–∞—Å—Ç—Ä–æ–∏—Ç—å cron (–∫–∞–∂–¥—ã–π —á–∞—Å, –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)"
echo "3) –ù–∞—Å—Ç—Ä–æ–∏—Ç—å cron (—Ç–æ–ª—å–∫–æ —Ä–∞–±–æ—á–∏–µ —á–∞—Å—ã 9-18)"
echo "4) –ù–∞—Å—Ç—Ä–æ–∏—Ç—å cron (–∫–∞–∂–¥—ã–µ 2 —á–∞—Å–∞)"
echo "5) –¢–µ—Å—Ç–æ–≤—ã–π –∑–∞–ø—É—Å–∫ (–æ–¥–Ω–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ)"
echo "6) –ü–æ–∫–∞–∑–∞—Ç—å —Å—Ç–∞—Ç—É—Å"
echo ""
read -p "–í–∞—à –≤—ã–±–æ—Ä (1-6): " choice

case $choice in
    1)
        echo "üöÄ –ó–∞–ø—É—Å–∫–∞—é –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–º 60 –º–∏–Ω—É—Ç..."
        echo "–î–ª—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –Ω–∞–∂–º–∏—Ç–µ Ctrl+C"
        python3 /Users/admin/MM-RAG/sync-with-monitoring.py --monitor --interval 60
        ;;
    2)
        echo "üìù –î–æ–±–∞–≤–ª—è—é –∑–∞–¥–∞—á—É –≤ cron (–∫–∞–∂–¥—ã–π —á–∞—Å)..."
        (crontab -l 2>/dev/null; echo "0 * * * * /Users/admin/MM-RAG/cron-update.sh") | crontab -
        echo "‚úÖ –ó–∞–¥–∞—á–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∞. –ü—Ä–æ–≤–µ—Ä–∫–∞:"
        crontab -l | grep MM-RAG
        ;;
    3)
        echo "üìù –î–æ–±–∞–≤–ª—è—é –∑–∞–¥–∞—á—É –≤ cron (—Ä–∞–±–æ—á–∏–µ —á–∞—Å—ã 9-18)..."
        (crontab -l 2>/dev/null; echo "0 9-18 * * * /Users/admin/MM-RAG/cron-update.sh") | crontab -
        echo "‚úÖ –ó–∞–¥–∞—á–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∞. –ü—Ä–æ–≤–µ—Ä–∫–∞:"
        crontab -l | grep MM-RAG
        ;;
    4)
        echo "üìù –î–æ–±–∞–≤–ª—è—é –∑–∞–¥–∞—á—É –≤ cron (–∫–∞–∂–¥—ã–µ 2 —á–∞—Å–∞)..."
        (crontab -l 2>/dev/null; echo "0 */2 * * * /Users/admin/MM-RAG/cron-update.sh") | crontab -
        echo "‚úÖ –ó–∞–¥–∞—á–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∞. –ü—Ä–æ–≤–µ—Ä–∫–∞:"
        crontab -l | grep MM-RAG
        ;;
    5)
        echo "üß™ –í—ã–ø–æ–ª–Ω—è—é —Ç–µ—Å—Ç–æ–≤–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ..."
        python3 /Users/admin/MM-RAG/sync-with-monitoring.py --check
        ;;
    6)
        echo "üìä –°—Ç–∞—Ç—É—Å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞:"
        echo ""
        echo "–ü—Ä–æ—Ü–µ—Å—Å—ã:"
        ps aux | grep sync-with-monitoring | grep -v grep || echo "  –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –Ω–µ –∑–∞–ø—É—â–µ–Ω"
        echo ""
        echo "Cron –∑–∞–¥–∞—á–∏:"
        crontab -l 2>/dev/null | grep MM-RAG || echo "  –ù–µ—Ç cron –∑–∞–¥–∞—á"
        echo ""
        echo "–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:"
        python3 /Users/admin/MM-RAG/show-history.py | grep "–ü–æ—Å–ª–µ–¥–Ω—è—è –∑–∞–ø–∏—Å—å"
        ;;
    *)
        echo "‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π –≤—ã–±–æ—Ä"
        ;;
esac